```mermaid
graph TD
    A[开始] --> B[接收短信内容]
    B --> A1[获取客户类型]
    A1 --> A2{客户类型验证}
    A2 -->|直客| A3[直接通过]
    A2 -->|其他有效类型| B1[检查双签名]
    
    B1 -->|多个签名| M[直接驳回]
    B1 -->|单个签名| C[清理短信内容]
    C --> C1[清理签名]
    C1 --> D{检查中性签名}
    D -->|中性签名| M[直接驳回] 
    D -->|正常签名| F[获取业务类型]
    
    F --> G{业务类型判断}

    %% 行业类检测流程    
    G -->|行业类| H[行业类评分]
    H --> H1[设置基础分: 行业-通知:100<br/>行业-物流:100]
    H1 --> H1A{特定签名?}
    H1A -->|是：饿了么| H1B[特定签名加分:+20]
    H1A -->|否| H1C{特殊关键词?}
    H1C -->|是：政府机构等| H1D[特殊关键词加分:+20]
    H1C -->|否| H2[检查私人号码]
    H1B --> H2
    H1D --> H2
    
    H2 -->|包含| M
    H2 -->|不包含| H3[检查链接]
    H3 --> H4[检查固定电话]
    H4 --> H5[检查营销关键词]
    H5 --> H6[检查强营销关键词]
    H6 --> H7[检查积分营销关键词]
    H7 --> H8[检查积分到期关键词]
    
    H8 --> H9{行业子类型}
    H9 -->|行业-通知| H10[通知类检测]
    H9 -->|行业-物流| H11[物流类检测]
    
    H10 --> H12[检查直播相关内容]
    H12 --> H13[检查微信公众号关键词]
    H13 --> H14[检查招聘相关词]
    H14 --> H15[检查会议相关词]
    H15 --> H16[检查交友相关词]
    H16 --> H17[检查征兵相关词]
    H17 --> H18[检查教育营销相关词]
    H18 --> H19[检查展会相关词]
    H19 --> H20[检查黄金珠宝相关词]
    H20 --> H21[检查酒水相关词]
    H21 --> H22[检查医疗相关词]
    H22 --> H23[检查游戏相关词]
    H23 --> H24[检查地址]
    H24 --> H25[应用扣分共现规则]
    
    H11 --> H26[检查物流关键词]
    H26 -->|包含| H27[物流关键词加分]
    H26 -->|不包含| H28[缺少物流关键词扣分]
    H27 --> H25
    H28 --> H25
    
    H25 --> H29[应用非线性扣分计算]
    
    %% 会销类检测流程
    G -->|会销类| I[会销类评分]
    I --> I1[设置基础分: 会销-普通:120<br/>会销-金融:100]
    I1 --> I1A{特定签名?}
    I1A -->|是：饿了么| I1B[特定签名加分:+20]
    I1A -->|否| I1C{特殊关键词?}
    I1C -->|是：政府机构等| I1D[特殊关键词加分:+20]
    I1C -->|否| I2[检查私人号码]
    I1B --> I2
    I1D --> I2
    
    I2 -->|包含| M
    I2 -->|不包含| I3[检查链接]
    I3 --> I4[检查固定电话]
    I4 --> I5[检查营销关键词]
    I5 --> I6[检查强营销关键词]
    I6 --> I7[检查积分营销关键词]
    I7 --> I8[检查积分到期关键词]
    I8 --> I9[检查展会相关词]
    I9 --> I10[检查黄金珠宝相关词]
    I10 --> I11[检查酒水相关词]
    I11 --> I12[检查医疗相关词]
    I12 --> I13[检查游戏相关词]
    I13 --> I14[检查交友相关词]
    I14 --> I15[检查微信公众号关键词]
    I15 --> I16[检查地址]
    I16 --> I17[应用扣分共现规则]
    I17 --> I18[应用非线性扣分计算]
    
    %% 拉新类检测流程
    G -->|拉新类| J[拉新类评分]
    J --> J1[设置基础分: 拉新-催收:100]
    J1 --> J1A{特定签名?}
    J1A -->|是：饿了么| J1B[特定签名加分:+20]
    J1A -->|否| J1C{特殊关键词?}
    J1C -->|是：政府机构等| J1D[特殊关键词加分:+20]
    J1C -->|否| J2[检查私人号码]
    J1B --> J2
    J1D --> J2
    
    J2 -->|包含| M
    J2 -->|不包含| J3[检查私人姓名]
    J3 -->|包含| M
    J3 -->|不包含| J4[检查催收关键词]
    J4 --> J5[检查链接]
    J5 --> J6[检查固定电话]
    J6 --> J7[应用扣分共现规则]
    J7 --> J8[应用非线性扣分计算]
    
    %% 最终评分判断
    H29 --> AE[计算最终得分]
    I18 --> AE
    J8 --> AE
    
    AE --> AF{得分判断}
    AF -->|行业:≥60分<br/>会销-普通:≥51分<br/>会销-金融:≥60分<br/>拉新:≥60分| AG[通过]
    AF -->|低于及格线| AH[驳回]
    
    AG --> AI[输出结果]
    AH --> AI
    M --> AI
    A3 --> AI

    %% 图例说明
    subgraph 图例
        Z1[非线性扣分计算: 防止多项扣分时总扣分过大]
        Z2[扣分共现规则: 当多种规则同时触发时增强扣分效果]
        Z3[计算最终得分: base_score + nonlinear_deduction + bonuses]
    end
    